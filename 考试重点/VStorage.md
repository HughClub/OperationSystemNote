# 虚拟存储器

从逻辑上扩充内存容量

>   将少数页面或段先装入内存便可运行 缺页/段则中断



>   **虚拟存储器:具有请求调入功能和置换功能 能从逻辑上对内存容量加以扩充的一种存储器系统

## 实现



实现

1.  [分页请求](#分页请求):分页系统+请求调页+页面置换
2.  [分段请求](#分段请求):分段系统+请求调段+分段置换

### 分页请求

置换时以**页面**为单位



必要的硬件支持

-   请求分页的页表机制
-   缺页中断机制
-   地址变换机制

### 分段请求

基本同上

### 内存分配策略

| 策略             | 英语                                    | 描述                                            |
| ---------------- | --------------------------------------- | ----------------------------------------------- |
| 固定分配局部置换 | Fixed Allocation, Local Replacement     | 分配固定数目物理块 在进程运行期间不再改变       |
| 可变分配全局置换 | Variable Allocation, Global Replacement | 先给每个进程分配一定数目的物理块 运行时适当增减 |
| 可变分配局部置换 | Variable Allocation, Local Replacement  | 先分配一定数量 频繁缺页则增减页数               |

### 物理块分配

1.  平均分配
2.  按比例分配
3.  考虑优先级的分配

## 页面置换算法

1.  最佳置换算法:替换未来不再被访问的页面
2.  FIFO
3.  LRU/LFU 最久/少使用置换
4.  Clock置换:LRU的近似算法
5.  PBA

## 抖动

>   进程在运行时 频繁缺页

### 工作集

>   在某段时间间隔$\Delta$里 进程实际所要访问页面的集合

把某进程在时间t的工作集记为$w(t,\Delta)$

${\rm{w}}(t,\Delta)\subseteq{\rm{w}}(t,\Delta+1)$

$\Delta$ 称为窗口大小

### 预防办法

1.  局部置换策略
2.  把工作集算法融入CPU调度
3.  利用"L=S"准则调节缺页率

    1.  L:缺页间的平均时间
    2.  S:平均缺页服务时间(置换所需时间)
4.  暂停进程



